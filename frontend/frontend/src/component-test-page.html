<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Token Factory Components Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        border: "hsl(214.3 31.8% 91.4%)",
                        input: "hsl(214.3 31.8% 91.4%)",
                        ring: "hsl(221.2 83.2% 53.3%)",
                        background: "hsl(0 0% 100%)",
                        foreground: "hsl(222.2 84% 4.9%)",
                        primary: {
                            DEFAULT: "hsl(221.2 83.2% 53.3%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        secondary: {
                            DEFAULT: "hsl(210 40% 96%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                        destructive: {
                            DEFAULT: "hsl(0 84.2% 60.2%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        muted: {
                            DEFAULT: "hsl(210 40% 96%)",
                            foreground: "hsl(215.4 16.3% 46.9%)",
                        },
                        accent: {
                            DEFAULT: "hsl(210 40% 96%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                        popover: {
                            DEFAULT: "hsl(0 0% 100%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                        card: {
                            DEFAULT: "hsl(0 0% 100%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                    },
                }
            }
        }
    </script>
    <style>
        .focus\:ring-2:focus {
            --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
            --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
            box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
        }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body class="bg-background text-foreground">
    <div id="root" class="container mx-auto p-8 space-y-8">
        <h1 class="text-3xl font-bold mb-8">Token Factory Components Test</h1>
        
        <!-- Component Test Sections -->
        <div id="wallet-connection-test"></div>
        <div id="network-selector-test"></div>
        <div id="token-form-test"></div>
        <div id="ui-components-test"></div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Mock wallet connection state
        const useMockWalletState = () => {
            const [isConnected, setIsConnected] = useState(false);
            const [address, setAddress] = useState('');
            const [chainId, setChainId] = useState(1);
            const [balance, setBalance] = useState(BigInt(0));

            const connect = async () => {
                // Simulate connection
                await new Promise(resolve => setTimeout(resolve, 1000));
                setIsConnected(true);
                setAddress('0x742d35Cc6635C0532925a3b8D05D38192db8a0E5');
                setBalance(BigInt('1500000000000000000')); // 1.5 ETH
            };

            const disconnect = () => {
                setIsConnected(false);
                setAddress('');
                setBalance(BigInt(0));
            };

            const switchNetwork = async (newChainId) => {
                setChainId(newChainId);
                return true;
            };

            return {
                isConnected,
                address,
                chainId,
                balance,
                connect,
                disconnect,
                switchNetwork
            };
        };

        // UI Components (simplified versions for testing)
        const Button = ({ 
            children, 
            variant = 'default', 
            size = 'default', 
            loading = false, 
            onClick, 
            className = '',
            ...props 
        }) => {
            const variants = {
                default: 'bg-primary text-primary-foreground hover:bg-primary/90',
                destructive: 'bg-destructive text-destructive-foreground hover:bg-destructive/90',
                outline: 'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
                ghost: 'hover:bg-accent hover:text-accent-foreground',
                gradient: 'bg-gradient-to-r from-blue-500 to-purple-600 text-white'
            };

            const sizes = {
                sm: 'h-9 px-3 text-sm',
                default: 'h-10 px-4 py-2',
                lg: 'h-11 px-8'
            };

            return (
                <button
                    className={`inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 ${variants[variant]} ${sizes[size]} ${className}`}
                    onClick={onClick}
                    disabled={loading}
                    data-testid={props['data-testid']}
                    {...props}
                >
                    {loading && <span className="animate-spin mr-2">⟳</span>}
                    {children}
                </button>
            );
        };

        const Card = ({ children, className = '', ...props }) => (
            <div className={`rounded-lg border bg-card text-card-foreground shadow-sm p-6 ${className}`} {...props}>
                {children}
            </div>
        );

        const Badge = ({ children, variant = 'default', className = '', ...props }) => {
            const variants = {
                default: 'bg-primary text-primary-foreground',
                secondary: 'bg-secondary text-secondary-foreground',
                success: 'bg-green-100 text-green-800',
                network: 'bg-gradient-to-r from-blue-500 to-purple-600 text-white'
            };

            return (
                <span className={`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold ${variants[variant]} ${className}`} {...props}>
                    {children}
                </span>
            );
        };

        const Select = ({ children, value, onValueChange, placeholder = "Select...", className = '', ...props }) => {
            return (
                <select 
                    className={`flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ${className}`}
                    value={value}
                    onChange={(e) => onValueChange?.(e.target.value)}
                    {...props}
                >
                    <option value="">{placeholder}</option>
                    {children}
                </select>
            );
        };

        // Wallet Connection Component
        const WalletConnection = ({ onConnect, onDisconnect }) => {
            const wallet = useMockWalletState();

            const handleConnect = async () => {
                await wallet.connect();
                onConnect?.(wallet.address, wallet.chainId);
            };

            const handleDisconnect = () => {
                wallet.disconnect();
                onDisconnect?.();
            };

            const formatAddress = (address) => {
                return address ? `${address.slice(0, 6)}...${address.slice(-4)}` : '';
            };

            const formatBalance = (balance) => {
                return (Number(balance) / 1e18).toFixed(4);
            };

            if (!wallet.isConnected) {
                return (
                    <div data-testid="wallet-connection-component" className="space-y-4">
                        <Button 
                            variant="gradient" 
                            onClick={handleConnect}
                            data-testid="connect-wallet-button"
                        >
                            🔗 Connect Wallet
                        </Button>
                    </div>
                );
            }

            return (
                <div data-testid="wallet-connection-component" className="space-y-4">
                    <Card data-testid="connected-wallet-card">
                        <div className="flex justify-between items-start mb-4">
                            <div>
                                <h3 className="font-semibold">Connected Wallet</h3>
                                <p className="text-sm text-muted-foreground">Chain ID: {wallet.chainId}</p>
                            </div>
                            <Badge variant="success" data-testid="connection-status">Connected</Badge>
                        </div>
                        
                        <div className="space-y-3">
                            <div>
                                <label className="text-sm font-medium">Address</label>
                                <div className="flex items-center justify-between mt-1">
                                    <code className="text-sm bg-muted px-2 py-1 rounded" data-testid="wallet-address">
                                        {formatAddress(wallet.address)}
                                    </code>
                                    <Button 
                                        variant="ghost" 
                                        size="sm"
                                        onClick={() => navigator.clipboard?.writeText(wallet.address)}
                                        data-testid="copy-address-button"
                                    >
                                        📋
                                    </Button>
                                </div>
                            </div>
                            
                            <div>
                                <label className="text-sm font-medium">Balance</label>
                                <div className="text-lg font-semibold" data-testid="wallet-balance">
                                    {formatBalance(wallet.balance)} ETH
                                </div>
                            </div>
                        </div>
                        
                        <div className="flex justify-between mt-4">
                            <Button variant="outline" size="sm" data-testid="view-explorer-button">
                                🔍 View Explorer
                            </Button>
                            <Button 
                                variant="destructive" 
                                size="sm" 
                                onClick={handleDisconnect}
                                data-testid="disconnect-button"
                            >
                                🔌 Disconnect
                            </Button>
                        </div>
                    </Card>
                </div>
            );
        };

        // Network Selector Component
        const NetworkSelector = ({ value, onChange }) => {
            const networks = [
                { id: 1, name: 'Ethereum', symbol: 'ETH' },
                { id: 56, name: 'BSC', symbol: 'BNB' },
                { id: 520, name: 'XSC', symbol: 'XSC' }
            ];

            return (
                <div data-testid="network-selector-component">
                    <label className="block text-sm font-medium mb-2">Network</label>
                    <Select
                        value={value || ''}
                        onValueChange={(newValue) => onChange?.(parseInt(newValue))}
                        data-testid="network-select"
                        placeholder="Choose network..."
                    >
                        {networks.map(network => (
                            <option key={network.id} value={network.id}>
                                {network.name} ({network.symbol})
                            </option>
                        ))}
                    </Select>
                </div>
            );
        };

        // Token Form Component
        const TokenBasicForm = ({ onSubmit }) => {
            const [formData, setFormData] = useState({
                name: '',
                symbol: '',
                totalSupply: '1000000',
                decimals: 18
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSubmit?.(formData);
            };

            const handleChange = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };

            return (
                <form onSubmit={handleSubmit} data-testid="token-basic-form" className="space-y-4">
                    <div>
                        <label className="block text-sm font-medium mb-2">Token Name</label>
                        <input
                            type="text"
                            value={formData.name}
                            onChange={(e) => handleChange('name', e.target.value)}
                            className="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
                            placeholder="My Token"
                            data-testid="token-name-input"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Token Symbol</label>
                        <input
                            type="text"
                            value={formData.symbol}
                            onChange={(e) => handleChange('symbol', e.target.value)}
                            className="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
                            placeholder="MTK"
                            data-testid="token-symbol-input"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Total Supply</label>
                        <input
                            type="number"
                            value={formData.totalSupply}
                            onChange={(e) => handleChange('totalSupply', e.target.value)}
                            className="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm"
                            data-testid="total-supply-input"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Decimals</label>
                        <Select
                            value={formData.decimals.toString()}
                            onValueChange={(value) => handleChange('decimals', parseInt(value))}
                            data-testid="decimals-select"
                        >
                            <option value="6">6</option>
                            <option value="8">8</option>
                            <option value="18">18</option>
                        </Select>
                    </div>

                    <Button type="submit" className="w-full" data-testid="submit-token-form">
                        Create Token Configuration
                    </Button>
                </form>
            );
        };

        // Main Test App
        const TestApp = () => {
            const [selectedNetwork, setSelectedNetwork] = useState(1);

            return (
                <div className="space-y-8">
                    <section>
                        <h2 className="text-2xl font-semibold mb-4">Wallet Connection Test</h2>
                        <WalletConnection 
                            onConnect={(address, chainId) => console.log('Connected:', { address, chainId })}
                            onDisconnect={() => console.log('Disconnected')}
                        />
                    </section>

                    <section>
                        <h2 className="text-2xl font-semibold mb-4">Network Selector Test</h2>
                        <NetworkSelector 
                            value={selectedNetwork}
                            onChange={(networkId) => {
                                setSelectedNetwork(networkId);
                                console.log('Network changed:', networkId);
                            }}
                        />
                    </section>

                    <section>
                        <h2 className="text-2xl font-semibold mb-4">Token Form Test</h2>
                        <Card>
                            <TokenBasicForm 
                                onSubmit={(data) => console.log('Form submitted:', data)}
                            />
                        </Card>
                    </section>

                    <section>
                        <h2 className="text-2xl font-semibold mb-4">UI Components Test</h2>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <h3 className="font-medium mb-2">Buttons</h3>
                                <div className="space-y-2">
                                    <Button data-testid="default-button">Default</Button>
                                    <Button variant="outline" data-testid="outline-button">Outline</Button>
                                    <Button variant="destructive" data-testid="destructive-button">Destructive</Button>
                                    <Button variant="gradient" data-testid="gradient-button">Gradient</Button>
                                </div>
                            </div>
                            
                            <div>
                                <h3 className="font-medium mb-2">Badges</h3>
                                <div className="flex flex-wrap gap-2">
                                    <Badge data-testid="default-badge">Default</Badge>
                                    <Badge variant="success" data-testid="success-badge">Success</Badge>
                                    <Badge variant="network" data-testid="network-badge">Ethereum</Badge>
                                </div>
                            </div>

                            <div>
                                <h3 className="font-medium mb-2">Status</h3>
                                <div className="space-y-2">
                                    <div className="flex items-center space-x-2">
                                        <div className="w-3 h-3 bg-green-500 rounded-full" data-testid="status-connected"></div>
                                        <span>Connected</span>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <div className="w-3 h-3 bg-yellow-500 rounded-full animate-pulse" data-testid="status-pending"></div>
                                        <span>Pending</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<TestApp />, document.getElementById('root'));

        // Make components available for Playwright testing
        window.testComponents = {
            WalletConnection,
            NetworkSelector,
            TokenBasicForm,
            Button,
            Card,
            Badge
        };

        console.log('Test environment ready!');
    </script>
</body>
</html>